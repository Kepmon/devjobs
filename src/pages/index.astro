---
import BaseLayout from '../layouts/BaseLayout.astro';
import JobCard from '../components/JobCard.astro'
import FilterOptions from '../components/FilterOptions.astro'
import CustomButton from '../components/CustomButton.astro'
import { allJobsDb } from '../xata'

const jobs = await allJobsDb.getAll()
---

<BaseLayout title="DevJobs | Home">
	<main class="grid gap-32">
		<FilterOptions />
		<div class="grid pb-[104px]">
			<div class="grid md:grid-auto-fit-[350px] gap-y-[65px] gap-x-6" data-container="jobs">
				{jobs.map((job, index) => index + 1 <= 12 ? <JobCard job={job} />  : null)}
				<template data-template="jobs">
					{jobs.map((job) => <JobCard job={job} />)}
				</template>
			</div>
			{<CustomButton moreClasses='justify-self-center mt-14' dataLoad='index'>Load More</CustomButton>}
		</div>
	</main>
</BaseLayout>

<script>
	import { addListenerToLoadButton, addListenerToWindow } from "../helpers/loadMoreButton"
	import { addListenerToForm } from "../helpers/jobsForm"

	addListenerToLoadButton('button[data-load="index"]')
	addListenerToForm()
	addListenerToWindow('button[data-load="index"]')
</script>
